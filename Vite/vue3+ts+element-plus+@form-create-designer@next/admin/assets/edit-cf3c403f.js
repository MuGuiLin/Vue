import{d as V,h as F,r as d,j as S,c as B,w as t,a as o,o as P,b as e,e as m,k as A,_ as q}from"./index-a89cdc83.js";import{a as L,u as M,b as T,$ as u,c as $}from"./department-b2669846.js";const j=V({__name:"edit",setup(E){const{query:f}=L(),g=M(),a=F(),b=d({showBaseForm:!0,disabled:{showBaseForm:!1}}),h=d([{name:"main",title:"基础控件",list:[{icon:"icon-input",name:"input",label:"输入框"},{icon:"icon-radio",name:"radio",label:"单选框"},{icon:"icon-checkbox",name:"checkbox",label:"多选框"},{icon:"icon-select",name:"select",label:"选择器"},{icon:"icon-switch",name:"switch",label:"开关"},{icon:"icon-slider",name:"slider",label:"滑块"},{icon:"icon-date",name:"datePicker",label:"日期"},{icon:"icon-time",name:"timePicker",label:"时间"}]}]),c=d({depID:f.id||"",depName:""}),w=()=>{a.value.clearDragRule(),a.value.clearActiveRule()},y=()=>{a.value.previewFc()},v=async()=>{if(!c.depName)return u({showClose:!0,message:"对不起：请填写部门名称！",type:"warning"}),!1;if(a.value.getRule().length){const n=[];JSON.parse(a.value.getJson()).forEach(l=>{l!=null&&l.field&&n.push({filed:(l==null?void 0:l.field)||A(),filedName:l.title,fieldType:l.type==="timePicker"||l.type==="datePicker"?"timestamp":"text"})});const{message:i="保存成功！"}=await $({...c,formJson:a.value.getJson(),formOption:JSON.stringify(a.value.getOption()),formField:JSON.stringify(n)});u({showClose:!0,message:i,type:"success",onClose:g.back})}else u({showClose:!0,message:"对不起：请正确添加表单项！",type:"error"})};return S(async()=>{if(console.log("designer",a.value),c.depID)try{const{data:{dep:n}}=await T({depID:c.depID});c.depID=n.depID,c.depName=n.depName,n.formOption&&a.value.setOption(JSON.parse(n.formOption)),n.formJson&&a.value.setRule(JSON.parse(n.formJson))}catch(n){console.error(n)}}),(n,s)=>{const i=o("el-input"),l=o("el-form-item"),_=o("el-col"),N=o("Delete"),r=o("el-icon"),p=o("el-button"),k=o("el-popconfirm"),x=o("View"),C=o("List"),D=o("el-row"),J=o("fc-designer"),O=o("el-card"),I=o("el-main");return P(),B(I,{class:"department-edit"},{default:t(()=>[e(O,null,{header:t(()=>[e(D,{class:"top-setup"},{default:t(()=>[e(_,{span:6},{default:t(()=>[e(l,{label:"部门名称",prop:"depName"},{default:t(()=>[e(i,{modelValue:c.depName,"onUpdate:modelValue":s[0]||(s[0]=R=>c.depName=R),modelModifiers:{trim:!0},placeholder:"请输入部门名称！",autocomplete:"off",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(_,{span:12},{default:t(()=>[e(k,{width:"300","icon-color":"#F56C6C","confirm-button-text":"清空","cancel-button-text":"取消",title:"注：清空后将不能恢复，确定要清空吗？",onConfirm:w},{reference:t(()=>[e(p,{type:"danger"},{default:t(()=>[e(r,null,{default:t(()=>[e(N)]),_:1}),m("清 空 ")]),_:1})]),_:1}),e(p,{type:"success",onClick:y},{default:t(()=>[e(r,null,{default:t(()=>[e(x)]),_:1}),m("预 览 ")]),_:1}),e(p,{type:"primary",onClick:v},{default:t(()=>[e(r,null,{default:t(()=>[e(C)]),_:1}),m(" 保 存 ")]),_:1})]),_:1})]),_:1})]),default:t(()=>[e(J,{ref_key:"designer",ref:a,menu:h,config:b,height:"740px"},null,8,["menu","config"])]),_:1})]),_:1})}}});const z=q(j,[["__scopeId","data-v-9c8acc1b"]]);export{z as default};
